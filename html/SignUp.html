<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Document</title>
<link rel='stylesheet' type='text/css' href='../css/estilos.css' />
</head>
<body>
<h1>Ecclesiastical Hip Hop</h1>
<form class="formulario" id="form"><label>Correo:</label><br />
<input type="email" name="email" id="email" required="" /><br />
<label>Contrase&ntilde;a:</label><br />
<input type="password" id="pass" name="pass" required="" /><br />
<label>Repetir Contrase&ntilde;a:</label><br />
<input type="password" id="pass2" required="" /><br />
<br />
<input type="submit" value="Registrarse" class="btn" /></form>
<div id="response"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript">
</script><script type="text/javascript">
//<![CDATA[

   $("#form").submit(function(event){
       event.preventDefault();
     if($("#pass").val().length < 6){
       alert("La contrase&ntilde;a tiene que ser mayor de 6 caracteres");
     }
     else if($("#pass").val()!=$("#pass2").val()){
         alert("Las contrase&ntilde;as no coinciden.")
     }
     else{
       var data = new FormData(this);
       $.ajax({
         url: '../php/signUp.php',
         type: 'POST',
         data: data,
         processData: false,
         cache: false,
         contentType: false,
         success: function(e){
             switch(e){
               case "Correcto":
                   var dataForm = new FormData();
                   dataForm.append('email', $("#email").val());
                   dataForm.append('pass', $("#pass").val());
                   $.ajax({
                       url: '../php/login.php',
                       type: 'POST',
                       data: dataForm,
                       processData: false,
                       cache: false,
                       contentType: false,
                       success: function(e){
                           switch(e){
                             case "Correcto":
                               $(location).attr('href','Intro.html');
                               break;
                             case "Error":
                               $("#response").html("<strong>Usuario o contrase&ntilde;a incorrecto.<\/strong>");
                               break;
                             default:
                               $("#response").html("<strong>Ha ocurrido un error con el servidor.<\/strong>");
                               break;
                           }
                         }
                   
                 });
                 break;
                 

               case "Error1":
                 $("#response").html("<strong>Email ya en uso.<\/strong>");
                 break;
               case "Error2":
               $("#response").html("<strong>Error, no se ha podido completar el registro.<\/strong>");
               break;
               default:
               $("#response").html("<strong>Error del servior.<\/strong>");
               break;


             }
            }
       });
     }
     return false;
   });

//]]>
</script>
</body>
</html>